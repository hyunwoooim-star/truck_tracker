# 🚀 Truck Tracker 200% 완성도 메가 플랜

> **목표**: 실제 사용자(트럭 사장님 + 손님)가 **진짜 사용 가능한** 프로덕션 앱 만들기

---

## 📊 현재 상태 진단

| 항목 | 현황 | 문제점 |
|------|------|--------|
| 총 파일 수 | 235개 | 과다 (60% 불필요 추정) |
| 스크린 수 | 50개 | 껍데기만 있는 기능 다수 |
| 앱 용량 | 미측정 | 불필요 기능으로 비대화 추정 |
| 실사용 준비도 | 50% | 핵심 기능은 있으나 실용성 부족 |

---

## 🎯 Phase 0: 대수술 (기능 제거 & 단순화)

### A. 즉시 제거할 기능 (용량 절감 + 복잡도 감소)

#### 1. 소셜 피드 (139KB 절감) - 완전 제거
**이유**:
- Instagram 스타일 SNS는 트럭 찾기 앱의 본질과 무관
- 사장님들이 SNS까지 관리하기 부담
- 콘텐츠 관리(신고, 필터링) 리스크

**삭제 대상**:
- `lib/features/social_feed/` 전체
- `lib/features/social/` (user_profile_screen)
- Firestore `posts/` 컬렉션

#### 2. 결제 시스템 (115KB 절감) - 단순화
**이유**:
- 트럭 사장님들은 **현금장사**만 함
- 토스페이, PG사 연동은 오버스펙

**삭제**:
- `lib/features/payment/` 전체 (토스페이 웹뷰 등)
- `lib/features/order/` (주문 후 결제 흐름)

**대체**:
- **계좌이체 안내** 기능으로 교체
  - 사장님이 계좌번호 등록
  - 손님이 "선결제" 버튼 → 계좌번호 표시 + 복사
  - **클립보드 복사 → 은행앱 자동 열기** (Deep Link)
  - "송금 완료" 체크박스 (셀프 체크)

#### 3. 픽업 네비게이션 (114KB 절감) - 제거
**이유**:
- 트럭은 고정 위치에 있음 (이동 중이 아님)
- 카카오맵/네이버지도 연동으로 충분

**삭제**:
- `lib/features/pickup_navigation/` 전체

**대체**:
- 트럭 상세 화면에서 "카카오맵으로 보기" 버튼

#### 4. 스탬프 카드 (95KB 절감) - 제거 또는 초간소화
**이유**:
- 사장님들이 매번 체크하기 번거로움
- QR 찍고 스탬프 적립하는 흐름이 복잡

**삭제**:
- `lib/features/stamp_card/` 전체

**대체 (선택)**:
- 체크인 횟수만 카운트 (자동)
- 쿠폰은 사장님이 수동 발급

#### 5. 1:1 채팅 (103KB 절감) - 제거
**이유**:
- 트럭 사장님들이 실시간 채팅 응대 불가능
- 고객센터 운영 리소스 없음

**삭제**:
- `lib/features/chat/` 전체
- `lib/features/support/` (support_chat_screen)

**대체**:
- 리뷰 시스템으로 소통 (이미 있음)
- 트럭 상세에 "전화하기" 버튼 (직접 통화)

#### 6. 쿠폰 시스템 (79KB) - 초간소화
**현재 문제**:
- 발급, 유효기간, QR 스캔 등 복잡
- 사장님들이 관리하기 어려움

**개선**:
- 쿠폰 **발급만** 남기기
- QR 스캔 제거 → 손님이 계산 시 "쿠폰 사용해요" 구두 전달
- 사장님이 앱에서 수동 차감

#### 7. 광고 시스템 - 제거
**이유**:
- 수익화 전까지 불필요
- 초기에는 사용성이 우선

**삭제**:
- `lib/features/ads/` 전체

---

### B. 제거 예상 효과

| 항목 | 절감 용량 | 절감 파일 수 |
|------|-----------|-------------|
| 소셜 피드 | 139KB | ~30개 |
| 결제 시스템 | 115KB | ~20개 |
| 픽업 네비게이션 | 114KB | ~15개 |
| 1:1 채팅 | 103KB | ~15개 |
| 스탬프 카드 | 95KB | ~10개 |
| 광고 | ~20KB | ~5개 |
| **합계** | **~586KB (35%)** | **~95개 (40%)** |

**결과**: 235개 파일 → **140개 파일**로 경량화

---

## 🎯 Phase 1: 핵심 기능 실용성 강화

### A. 계좌이체 시스템 구축 ✨

#### 기능 명세
1. **사장님**: 설정에서 계좌번호 등록
   - 은행명, 예금주, 계좌번호
   - Firebase `truck_details/{truckId}.bankAccount` 저장

2. **손님**: 메뉴 선택 → "선결제하기" 버튼
   - 총 금액 + 계좌번호 표시
   - **"계좌번호 복사" 버튼** → 클립보드 복사
   - **"송금하기" 버튼** → 은행앱 열기
     - Android: `intent://` 스킴
     - iOS: Universal Link 시도
     - 실패 시: 토스/카카오페이 송금 페이지 웹뷰

3. **송금 확인**:
   - "송금 완료했어요" 체크박스 (셀프 체크)
   - 주문 메모에 "입금자명" 입력
   - 사장님 대시보드에서 주문 목록 확인

#### 구현 파일
- `lib/features/bank_transfer/`
  - `domain/bank_account.dart` (Freezed)
  - `data/bank_transfer_repository.dart`
  - `presentation/bank_transfer_screen.dart`
  - `presentation/bank_account_setup_screen.dart` (사장님용)

#### 예상 공수
- 1일 (은행앱 연동 테스트 포함)

---

### B. 주문 시스템 단순화

**현재 문제**:
- PG 연동 전제로 복잡한 주문 흐름
- 장바구니 → 결제 → 픽업 단계가 과도

**개선**:
1. **주문 흐름**:
   ```
   메뉴 선택 → 장바구니 → 주문서 작성 (선결제/현장결제 선택)
   → 선결제: 계좌이체 안내 표시
   → 현장결제: 바로 주문 완료
   ```

2. **사장님 주문 관리**:
   - 대시보드에서 주문 목록 실시간 확인
   - "준비 중" → "준비 완료" → "픽업 완료" 상태 변경
   - 푸시 알림: 새 주문 시 알림

3. **손님 주문 상태 확인**:
   - 내 주문 화면에서 실시간 상태 확인
   - 푸시 알림: 준비 완료 시 알림

#### 수정 파일
- `lib/features/order/` 리팩토링
- `lib/features/owner_dashboard/presentation/order_management_screen.dart` 신규

#### 예상 공수
- 2일

---

### C. 지도 & 트럭 찾기 UX 개선

**현재 문제**:
- PC 웹은 반응형 완성됐으나, 모바일 UX 개선 여지

**개선**:
1. **필터 강화**:
   - "지금 영업 중" 필터 (기본 ON)
   - "선결제 가능" 필터 추가
   - "내 위치 1km 이내" 빠른 필터

2. **검색 개선**:
   - 검색창에서 "음식 종류", "트럭 이름", "위치" 통합 검색
   - 자동완성 추천

3. **즐겨찾기 빠른 액세스**:
   - 홈 화면에 "자주 가는 트럭" 섹션
   - 즐겨찾기한 트럭의 영업 시작 알림

#### 예상 공수
- 1일

---

### D. 리뷰 시스템 강화 (사장님 소통 채널)

**채팅 대신 리뷰로 소통**:
1. **손님**:
   - 방문 후 리뷰 작성 (별점 + 사진 + 텍스트)
   - "문의" 태그 추가 (질문용 리뷰)

2. **사장님**:
   - 리뷰 답글 알림
   - 답글 작성 (공개 소통)
   - "문의" 태그 리뷰 우선 표시

3. **신고 시스템**:
   - 부적절한 리뷰 신고 → 관리자 검토

#### 수정 파일
- `lib/features/review/` 강화
- `lib/features/owner_dashboard/presentation/review_management_screen.dart` 개선

#### 예상 공수
- 1일

---

### E. 트럭 사장님 온보딩 개선

**현재 문제**:
- 5단계 온보딩이 너무 김
- 필수 정보만 받고 나머지는 나중에

**개선**:
1. **필수 정보만 온보딩**:
   - 1단계: 사업자 등록증 + 트럭 번호
   - 2단계: 트럭 기본 정보 (음식 종류, 사진)
   - 3단계: 계좌번호 (선결제용)
   - 완료!

2. **선택 정보는 대시보드에서**:
   - 메뉴 등록
   - 스케줄 설정
   - 공지사항

#### 예상 공수
- 0.5일

---

### F. 알림 시스템 실용화

**현재 상태**: 163KB로 큰데 실제 활용도는?

**개선**:
1. **손님에게 유용한 알림**:
   - 즐겨찾기 트럭 영업 시작
   - 주문 준비 완료
   - 쿠폰 발급

2. **사장님에게 유용한 알림**:
   - 새 주문 접수
   - 리뷰 작성됨
   - 사업자 승인 완료

3. **불필요한 알림 제거**:
   - 마케팅성 알림 제거
   - 설정에서 알림 세부 제어

#### 예상 공수
- 0.5일

---

## 🎯 Phase 2: 안정성 & 성능 개선

### A. 오류 처리 강화

**현재 문제**:
- 네트워크 끊김, Firestore 오류 시 UX 불명확

**개선**:
1. **전역 오류 핸들러**:
   - Sentry 연동 강화 (이미 있음)
   - 사용자 친화적 오류 메시지

2. **재시도 로직**:
   - 네트워크 오류 시 자동 재시도
   - "다시 시도" 버튼 명확히

3. **오프라인 지원**:
   - 트럭 목록 캐싱 (마지막 조회 결과)
   - "오프라인 모드" 안내

#### 예상 공수
- 1일

---

### B. 로딩 성능 최적화

**현재 성과**: 로그인 6-8초 → 1-2초 개선 완료

**추가 최적화**:
1. **지도 로딩**:
   - 마커 lazy loading (화면에 보이는 것만)
   - 이미지 프리로드

2. **트럭 리스트**:
   - 무한 스크롤 페이지네이션
   - 이미지 lazy loading

3. **대시보드**:
   - 통계 데이터 캐싱

#### 예상 공수
- 1일

---

### C. 앱 용량 최적화

**현재 추정**: 불필요 기능 제거 후 추가 최적화

1. **이미지 최적화**:
   - WebP 압축 강화 (이미 있음)
   - 썸네일 생성 (Cloud Functions)

2. **코드 분할**:
   - 관리자 기능 lazy load
   - 사용 빈도 낮은 기능 defer

3. **패키지 정리**:
   - 미사용 패키지 제거
   - `pubspec.yaml` 최적화

#### 예상 공수
- 0.5일

---

## 🎯 Phase 3: 실사용 대비 마무리

### A. 사용자 가이드 & 온보딩

1. **첫 사용자 튜토리얼**:
   - 손님: 지도 사용법, 주문 방법
   - 사장님: 영업 시작/종료, 주문 확인

2. **도움말 센터**:
   - FAQ (자주 묻는 질문)
   - 기능별 가이드

3. **빈 상태 안내**:
   - 주변에 트럭 없을 때 안내
   - 아직 주문 없을 때 안내

#### 예상 공수
- 0.5일

---

### B. 베타 테스트 준비

1. **테스트 시나리오 작성**:
   - 손님 여정: 가입 → 트럭 찾기 → 주문 → 리뷰
   - 사장님 여정: 가입 → 승인 → 영업 시작 → 주문 처리

2. **버그 리포팅 채널**:
   - 앱 내 "버그 신고" 버튼
   - Google Form 연동

3. **모니터링 대시보드**:
   - Sentry 에러 확인
   - Firebase Analytics 사용 패턴 분석

#### 예상 공수
- 0.5일

---

### C. 법적 준비

1. **이용약관**:
   - 서비스 이용약관 (이미 있음?)
   - 업데이트 필요

2. **개인정보처리방침**:
   - GDPR 준수 (이미 있음?)
   - 계좌번호 처리 명시

3. **사업자 정보**:
   - 앱 내 "사업자 정보" 표기

#### 예상 공수
- 0.5일

---

## 📅 전체 일정 (총 10일)

| Phase | 작업 | 예상 공수 | 우선순위 |
|-------|------|-----------|----------|
| **Phase 0** | 불필요 기능 제거 | **2일** | 🔥 최우선 |
| **Phase 1-A** | 계좌이체 시스템 | 1일 | 🔥 최우선 |
| **Phase 1-B** | 주문 시스템 단순화 | 2일 | 🔥 최우선 |
| **Phase 1-C** | 지도 UX 개선 | 1일 | 중 |
| **Phase 1-D** | 리뷰 시스템 강화 | 1일 | 중 |
| **Phase 1-E** | 온보딩 개선 | 0.5일 | 중 |
| **Phase 1-F** | 알림 실용화 | 0.5일 | 중 |
| **Phase 2-A** | 오류 처리 강화 | 1일 | 중 |
| **Phase 2-B** | 로딩 최적화 | 1일 | 낮음 |
| **Phase 2-C** | 용량 최적화 | 0.5일 | 낮음 |
| **Phase 3-A** | 사용자 가이드 | 0.5일 | 중 |
| **Phase 3-B** | 베타 테스트 준비 | 0.5일 | 중 |
| **Phase 3-C** | 법적 준비 | 0.5일 | 중 |
| **합계** | | **11.5일** | |

---

## 🎯 핵심 우선순위 (최우선 3일 작업)

**Day 1-2: Phase 0 (기능 제거)**
- 소셜 피드, 결제, 픽업 네비게이션, 채팅, 스탬프, 광고 제거
- 앱 경량화 & 단순화

**Day 3: Phase 1-A (계좌이체)**
- 실 사용 가능한 결제 시스템 구축
- 은행앱 연동

**완료 후 상태**:
- 앱 용량 35% 감소
- 핵심 기능만 남음
- 실제 돈 거래 가능

---

## 🚀 200% 완성도 달성 기준

| 항목 | 기준 |
|------|------|
| ✅ 기능 정리 | 불필요한 기능 40% 제거 |
| ✅ 실사용 가능 | 계좌이체 + 주문 시스템 완성 |
| ✅ 안정성 | 치명적 버그 0개 |
| ✅ 성능 | 앱 로딩 2초 이내 |
| ✅ UX | 사용자 가이드 완비 |
| ✅ 법적 준비 | 이용약관 + 개인정보처리방침 |
| ✅ 베타 테스트 | 10명 이상 실사용 테스트 완료 |

---

**다음 단계**: Phase 0 시작 승인 대기
